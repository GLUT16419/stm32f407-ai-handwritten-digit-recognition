# STM32F407 AI 手写数字识别项目

## 项目概述

本项目基于STM32F407微控制器和STM32Cube.AI，实现了手写数字识别功能。通过上位机应用程序（HandWriteApp.exe）绘制数字，然后将数据发送到STM32F407微控制器，使用AI模型进行识别，并返回识别结果。

## 项目结构

```
├── .ai/                     # AI模型配置文件
├── .trae/                   # Trae IDE配置文件
├── ZGT6/                    # STM32项目文件
│   ├── Core/                # 核心代码
│   │   ├── Inc/             # 头文件
│   │   └── Src/             # 源代码
│   ├── Drivers/             # 驱动库
│   │   ├── CMSIS/           # CMSIS库
│   │   └── STM32F4xx_HAL_Driver/ # HAL驱动
│   ├── EWARM/               # IAR Embedded Workbench项目文件
│   └── MDK-ARM/             # Keil MDK项目文件
├── HandWriteApp.exe         # 上位机应用程序
├── STM32cube_ai分析.md      # STM32Cube.AI分析文档
├── STM32实际测试数据.txt     # STM32实际测试结果
├── mnist_model_98.76_91.58.onnx # MNIST手写数字识别模型
└── README.md                # 项目说明文档
```

## 硬件要求

- STM32F407微控制器开发板
- USB数据线（用于串口通信）
- 电脑（运行上位机应用）

## 软件要求

- STM32CubeMX（版本6.0或更高）
- STM32CubeIDE或Keil MDK或IAR Embedded Workbench
- STM32Cube.AI（AI扩展包）
- 上位机应用程序（HandWriteApp.exe）

## 使用方法

### 1. 硬件连接

1. 使用USB数据线将STM32F407开发板连接到电脑
2. 确保开发板已正确供电

### 2. 上位机使用

1. 运行`HandWriteApp.exe`上位机应用程序
2. 在绘图区域绘制数字（0-9）
3. 点击"发送"按钮将数据发送到STM32
4. 等待并查看识别结果

### 3. STM32配置

1. 使用STM32CubeMX打开`ZGT6/ZGT6.ioc`文件
2. 确保已启用USART串口通信
3. 生成代码并编译
4. 将代码烧录到STM32F407开发板

## AI模型

本项目使用MNIST手写数字识别模型，模型文件为`mnist_model_98.76_91.58.onnx`。该模型在MNIST测试集上的准确率为98.76%，在STM32F407上的准确率为91.58%。

### 模型架构

- 输入：28x28像素的灰度图像
- 输出：10个类别的概率分布（对应数字0-9）
- 中间层：卷积神经网络

## 测试结果

根据`STM32实际测试数据.txt`文件，STM32F407实际测试结果如下：

### 测试数据统计

| 数字 | 测试次数 | 正确次数 | 准确率 |
|------|----------|----------|--------|
| 0    | 5        | 4        | 80.0%  |
| 1    | 5        | 5        | 100.0% |
| 2    | 5        | 5        | 100.0% |
| 3    | 5        | 5        | 100.0% |
| 4    | 6        | 5        | 83.3%  |
| 5    | 5        | 4        | 80.0%  |
| 6    | 5        | 3        | 60.0%  |
| 7    | 5        | 5        | 100.0% |
| 8    | 5        | 5        | 100.0% |
| 9    | 4        | 3        | 75.0%  |
| **总计** | **54** | **48** | **88.9%** |

### 识别准确率

- 整体准确率：88.9%
- 数字8、7、2、3、1：100%准确率
- 数字4：83.3%准确率
- 数字9、5、0：80%左右准确率
- 数字6：60%准确率

## 项目特点

1. **端到端解决方案**：从上位机绘制到STM32识别的完整流程
2. **实时识别**：在STM32F407上实现实时手写数字识别
3. **易于使用**：提供直观的上位机界面
4. **可扩展性**：可基于此项目扩展其他AI应用
5. **低功耗**：在STM32F407这样的低功耗平台上运行AI模型

## 开发环境设置

1. **安装STM32CubeMX**
   - 从ST官网下载并安装STM32CubeMX
   - 安装STM32Cube.AI扩展包

2. **导入项目**
   - 使用STM32CubeMX打开`ZGT6/ZGT6.ioc`文件
   - 生成代码

3. **编译和烧录**
   - 使用Keil MDK、IAR或STM32CubeIDE打开项目
   - 编译代码
   - 将代码烧录到STM32F407开发板

## 故障排除

### 上位机连接问题

- 确保USB驱动已正确安装
- 检查串口连接和波特率设置
- 确认STM32开发板已正确供电

### 识别准确率问题

- 确保数字绘制在指定区域内
- 数字应清晰可辨，不要过于潦草
- 尝试调整绘制速度和线条粗细

## 许可证

本项目使用STMicroelectronics的STM32Cube.AI扩展包，遵循其许可证条款。

## 联系方式

如有问题或建议，欢迎联系项目维护者。

---

**项目版本**：v1.0.0
**最后更新**：2026年1月29日
**开发团队**：STM32 AI Project Team
